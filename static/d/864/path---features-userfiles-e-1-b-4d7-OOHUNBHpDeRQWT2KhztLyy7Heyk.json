{"data":{"article":{"html":"<p><code>user.js</code> and <code>user.css</code> allow you to inject custom code into any service. This can be used to automate or alter the service in any form, e.g. adding custom styles or adding a script to automatically login.</p>\n<p><code>user.js</code> and <code>user.css</code> are only stored locally on your device and won't be transmitted to other devices that use the same account.</p>\n<h2>Editing the files</h2>\n<p>To edit <code>user.js</code> or <code>user.css</code>, open Ferdi's settings using the cog in the bottom left corner, in the left sidebar go to \"Services\" and choose a service.\nOn this screen, scroll down and click one of the buttons <code>Open darkmode.css</code>, <code>Open user.css</code> or <code>Open user.js</code>:</p>\n<ul>\n<li><code>darkmode.css</code> will only be injected into the page if you have enabled dark mode inside Ferdi</li>\n<li><code>user.css</code> will always be injected</li>\n<li><code>user.js</code> will always be injected. The file will only be injected after the DOM completed loading</li>\n</ul>\n<p>Please note that these buttons will only show up when editing existing services - not when creating a new service as the files have not been created yet there.</p>\n<p>After editing one of those files, you can reload the current service using CMD/CTRL + R.</p>\n<p>Please keep in mind that the same <code>user.css</code> and <code>user.js</code> file will be loaded for <strong>all</strong> services that use the same recipe (e.g. all Telegram services use the same <code>user.js</code> and <code>user.css</code>). You can however add service-specific features using the helpers mentioned below. </p>\n<h2>User.js</h2>\n<p>When opening a <code>user.js</code> file for the first time, you will see that the file contains the following template:</p>\n<p>Example:</p>\n<pre><code class=\"language-JavaScript\">module.exports = (config, Ferdi) => {\n  // Write your scripts here\n  console.log(\"Hello, World!\", config);\n}\n</code></pre>\n<p>You script will be executed inside the service itself (i.e. your code has full access to the page). Additionally, you get the following arguments to help you write your code:</p>\n<ol>\n<li>\n<p><code>config</code>: Configuration of the current service. This config will look something like this</p>\n<pre><code class=\"language-JavaScript\">{\n\"franzVersion\": \"5.4.4-beta.1\", // Current version of Ferdi\n\"hasCustomIcon\": false, // true if you uploaded your own icon\n\"id\": \"31b3dba0-efb7-4ecf-919b-084d68160bb1\", // Unique ID for every instance of a recipe\n\"isDarkModeEnabled\": false,\n\"spellcheckerLanguage\": \"en-EN\",\n\"team\": \"\",\n\"url\": \"https://web.telegram.org\",\n\"recipe\": { // General information about the recipe\n\"description\": \"Telegram\",\n\"disablewebsecurity\": false,\n\"hasCustomUrl\": false,\n\"hasDirectMessages\": true,\n\"hasHostedOption\": false,\n\"hasIndirectMessages\": false,\n\"hasNotificationSound\": true,\n\"hasPredefinedUrl\": false,\n\"hasTeamId\": false,\n\"id\": \"telegram\",\n\"message\": \"\",\n\"name\": \"Telegram\",\n\"path\": \"/Users/.../Library/Application Support/Ferdi/recipes/telegram\",\n\"rawAuthor\": \"Stefan Malzner &#x3C;stefan@adlk.io>\",\n\"serviceURL\": \"https://web.telegram.org\",\n\"urlInputPrefix\": \"\",\n\"urlInputSuffix\": \"\",\n\"version\": \"1.0.5\"\n}\n}\n</code></pre>\n</li>\n<li>\n<p><code>Ferdi</code>: The Ferdi instance allows you to interact with Ferdi. It is an instance of the <code>Userscript</code> class (see <a href=\"https://github.com/getferdi/ferdi/blob/develop/src/webview/lib/Userscript.js\">https://github.com/getferdi/ferdi/blob/develop/src/webview/lib/Userscript.js</a>). You can find the full documentation of this class below:</p>\n</li>\n</ol>\n<h3>Ferdi instance</h3>\n<p>The <code>Ferdi</code> instance gives the script the following methods and variables:</p>\n<p><code>config</code> - Service configuration, same as the first \"config\" argument</p>\n<p><code>settings</code> - Full settings object, containing Ferdi's and the service's settings. Please note that this object should be treated <em>read-only</em> - you can not change settings through it! The settings object will look like this:</p>\n<pre><code>{\n   \"overrideSpellcheckerLanguage\":false,\n   \"app\":{ // Ferdi's settings\n      \"autoLaunchInBackground\":false,\n      \"runInBackground\":true,\n      \"reloadAfterResume\":true,\n      \"enableSystemTray\":false,\n      \"startMinimized\":true,\n      \"minimizeToSystemTray\":false,\n      \"privateNotifications\":false,\n      \"showDisabledServices\":true,\n      \"showMessageBadgeWhenMuted\":true,\n      \"showDragArea\":true,\n      \"enableSpellchecking\":true,\n      \"spellcheckerLanguage\":\"en-us\",\n      \"darkMode\":false,\n      \"locale\":\"en-US\",\n      \"fallbackLocale\":\"en-US\",\n      \"beta\":false,\n      \"isAppMuted\":false,\n      \"enableGPUAcceleration\":true,\n      \"serviceLimit\":5,\n      \"server\":\"https://api.getferdi.com\",\n      \"predefinedTodoServer\":\"https://app.franztodos.com\",\n      \"autohideMenuBar\":false,\n      \"lockingFeatureEnabled\":false,\n      \"locked\":false,\n      \"lockedPassword\":\"\",\n      \"useTouchIdToUnlock\":true,\n      \"scheduledDNDEnabled\":false,\n      \"scheduledDNDStart\":\"17:00\",\n      \"scheduledDNDEnd\":\"09:00\",\n      \"hibernate\":true,\n      \"hibernationStrategy\":\"10\",\n      \"inactivityLock\":0,\n      \"automaticUpdates\":true,\n      \"showServiceNavigationBar\":false,\n      \"universalDarkMode\":true,\n      \"adaptableDarkMode\":false,\n      \"accentColor\":\"#7367f0\",\n      \"serviceRibbonWidth\":68,\n      \"iconSize\":20,\n      \"sentry\":false,\n      \"navigationBarBehaviour\":\"never\",\n      \"customTodoServer\":\"\",\n      \"noUpdates\":false,\n      \"todoServer\":\"isUsingCustomTodoService\",\n      \"isDarkThemeActive\":false\n   },\n   \"service\":{ \n       // ... Same as \"config\"\n   }\n}\n</code></pre>\n<p>The settings object can change through time. When first loading the user script this settings object will most likely not contain your customised settings yet as the settings have to be loaded through Electron. To make sure that you are getting the right settings, you may want to also register a settings handler:</p>\n<p><code>onSettingsUpdate(handler)</code> - Set a custom callback that should be called when the settings object above has changed</p>\n<pre><code class=\"language-JavaScript\">module.exports = (config, Ferdi) => {\n  Ferdi.onSettingsUpdate(() => {\n      console.log(Ferdi.settings);\n  });\n}\n</code></pre>\n<p><code>setBadge(direct = 0, indirect = 0)</code> - Set badge count (unread messages count) for the current service</p>\n<pre><code class=\"language-JavaScript\">module.exports = (config, Ferdi) => {\n  let i = 1;\n  // Increase the badge count by one every second\n  setInterval(() => {\n     Ferdi.setBadge(i);\n     i += 1;\n  }, 1000);\n}\n</code></pre>\n<p><code>injectCSSFiles(...files)</code> - Inject local CSS file or files into the page</p>\n<pre><code class=\"language-JavaScript\">module.exports = (config, Ferdi) => {\n  // With one file:\n  Ferdi.injectCSSFiles(\"C:/.../Desktop/style.css\");\n  // With multiple files:\n  Ferdi.injectCSSFiles(\"C:/.../Desktop/style.css\", \"C:/.../Documents/style.css\");\n}\n</code></pre>\n<p><code>injectCSS(styles)</code> - Inject CSS string into the page</p>\n<pre><code class=\"language-JavaScript\">module.exports = (config, Ferdi) => {\n  Ferdi.injectCSS(`body {\n    background-color: red;\n  }`);\n}\n</code></pre>\n<p><code>openFindInPage()</code> - Open the \"Find in Page\" popup</p>\n<pre><code class=\"language-JavaScript\">module.exports = (config, Ferdi) => {\n  Ferdi.openFindInPage();\n}\n</code></pre>\n<p><code>set(key, value)</code> and <code>get(key)</code> - Simple key-value store that can be used inside user scripts to save state.</p>\n<pre><code class=\"language-JavaScript\">module.exports = (config, Ferdi) => {\n  if (Ferdi.get(\"hasBeenLoadedBefore\")) {\n    // ...\n  }\n\n  Ferdi.set(\"hasBeenLoadedBefore\", true);\n}\n</code></pre>\n<p><code>externalOpen(url)</code> - Open a URL in an external browser. Normally, when using <code>window.open</code>, Ferdi will decide whether to open the URL in Ferdi or an external browser. With <code>Ferdi.externalOpen(...)</code> you can force Ferdi to open the URL externally.</p>\n<p><code>internalOpen(url)</code> - Open a URL in Ferdi. Normally, when using <code>window.open</code>, Ferdi will decide whether to open the URL in Ferdi or an external browser. With <code>Ferdi.internalOpen(...)</code> you can force Ferdi to open the URL inside Ferdi.</p>","frontmatter":{"path":"features/userfiles","title":"Using user.css and user.js (User-styles and User-scripts)"}},"footer":{"html":"<div \n  align=\"center\" \n  style=\"display:flex; justify-content: center;align-items:center;flex-direction:column;margin-top:2.5rem;\">\n  <h4>Still have questions?</h4>\n  <a href=\"https://github.com/getferdi/ferdi/issues\" style=\"display:flex;align-items:center;\">\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-github\"><path d=\"M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22\"></path></svg>\n    <span style=\"margin-left: 0.2rem;\">Create a new issue on GitHub</span>\n  </a>\n  <h4>Found a typo?</h4>\n  <a href=\"https://github.com/getferdi/wiki/issues\" style=\"display:flex;align-items:center;\">\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-file-text\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"></path><polyline points=\"14 2 14 8 20 8\"></polyline><line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"></line><line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"></line><polyline points=\"10 9 9 9 8 9\"></polyline></svg>\n    <span style=\"margin-left: 0.2rem;\">Report it on GitHub</span>\n  </a>\n</div>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"article":"features/userfiles"}}